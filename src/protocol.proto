package protocol;

message ClientMessage {
  oneof message {
    Authenticate authenticate = 1;
    PlayerState playerState = 2;
  }

  message Authenticate {
    required string playerName = 1;
  }

  message PlayerState {
    required int32 x = 1;
    required int32 y = 2;
  }
}

message ServerMessage {
  oneof message {
    Authenticated authenticated = 1;
    RoomInfo roomInfo = 2;
    RoomState roomState = 3;
  }

  message Authenticated {
    required uint32 playerID = 1;
  }

  message RoomInfo {
    message PlayerInfo {
      required uint32 id = 1;
      required string name = 2;
    }

    repeated PlayerInfo players = 1;
  }

  message RoomState {
    message PlayerState {
      enum State {
        // Keep in sync with PlayerState in player.ts.
        ALIVE = 1;
        DEAD = 2;
      }
      required uint32 id = 1;
      required int32 x = 2;
      required int32 y = 3;
      required State state = 4;
    }

    repeated PlayerState players = 1;
  }
}
